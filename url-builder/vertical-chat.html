<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings Builder - Vertical Chat - tawmae</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@streamerbot/client/dist/streamerbot-client.js"></script>
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            display: flex;
            height: 100vh;
            font-family: 'Poppins', sans-serif;
            background: #1e1e1e;
            color: #ccc;
            overflow: hidden;
        }

        .panel {
            width: 550px;
            padding: 20px;
            background: #2e2e2e;
            overflow-y: auto;
        }

        .setting-group {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #444;
        }

        .setting-group:last-child {
            border-bottom: none;
        }

        .setting-group label {
            display: block;
            margin-bottom: 5px;
            font-size: 14px;
            font-weight: 600;
        }

        .setting-group .desc {
            font-size: 12px;
            font-style: italic;
            color: #aaa;
            margin-top: 4px;
        }

        input,
        select,
        button {
            font-family: 'Poppins', sans-serif;
        }

        input[type="text"],
        input[type="number"],
        input[type="password"],
        select {
            width: 100%;
            padding: 8px;
            background: #1e1e1e;
            border: 1px solid #444;
            color: #ccc;
            border-radius: 4px;
        }

        .toggle-switch {
            display: inline-block;
            position: relative;
            width: 50px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-switch .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #444;
            border-radius: 12px;
            transition: .3s;
        }

        .toggle-switch .slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 2px;
            bottom: 2px;
            background: #ccc;
            border-radius: 50%;
            transition: .3s;
        }

        .toggle-switch input:checked+.slider {
            background: #46608f;
        }

        .toggle-switch input:checked+.slider:before {
            transform: translateX(26px);
        }

        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .checkbox-group label {
            display: flex;
            align-items: center;
        }

        .checkbox-group input[type="checkbox"] {
            margin-right: 8px;
            accent-color: #46608f;
        }

        .slider-group input[type="range"] {
            width: 100%;
            -webkit-appearance: none;
            background: transparent;
        }

        .slider-group input[type="range"]::-webkit-slider-runnable-track {
            height: 4px;
            background: #444;
            border-radius: 2px;
        }

        .slider-group input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #46608f;
            cursor: pointer;
            margin-top: -6px;
        }

        .slider-group input[type="range"]::-moz-range-track {
            height: 4px;
            background: #444;
            border-radius: 2px;
        }

        .slider-group input[type="range"]::-moz-range-thumb {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #46608f;
            cursor: pointer;
        }

        .slider-value {
            text-align: right;
            margin-top: 5px;
            font-size: 14px;
        }

        button#copy-button {
            padding: 8px 12px;
            background: #46608f;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background .3s;
            font-family: 'Poppins', sans-serif;
        }

        button#copy-button:hover {
            background: #5e75b2;
        }

        button#copy-button.copied {
            background: #4caf50;
        }

        .iframe-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            background: #000;
            padding: 20px;
            overflow: hidden;
        }

        .url-container {
            display: flex;
            align-items: center;
            gap: 10px;
            width: 80%;
            margin-bottom: 20px;
        }

        .url-wrapper {
            flex: 1;
            display: flex;
            align-items: center;
            background: #2e2e2e;
            padding: 10px;
            border: 1px solid #444;
            border-radius: 4px;
        }

        .url-wrapper input {
            flex: 1;
            padding: 8px;
            background: transparent;
            border: none;
            color: #ccc;
            font-size: 18px;
        }

        iframe {
            width: 100%;
            max-height: calc(100% - 150px);
            aspect-ratio: 9/16;
            border: 1px solid #444;
            border-radius: 4px;
        }

        .connection-section {
            display: flex;
            flex-direction: column;
            align-items: start;
        }

        .connection-section img {
            max-width: 200px;
        }

        .connection-section label {
            margin-top: 8px;
            font-size: 1.125rem;
        }

        .connection-group {
            display: flex;
            align-items: center;
        }

        .connection-group>div {
            margin-right: 15px;
        }

        .setting-group.status-group {
            border-bottom: none;
            padding-bottom: 0;
            margin-bottom: 20px;
        }

        .settings-title {
            font-size: 1.5rem !important;
            font-weight: 600;
            margin: 20px 0 10px;
        }

        .account-item {
            display: flex;
            gap: 8px;
            margin-bottom: 8px;
        }

        .account-item input {
            flex: 1;
        }

        .account-item button {
            padding: 4px 8px;
        }
    </style>
</head>

<body>
    <div class="panel">
        <div class="setting-group connection-section">
            <img src="https://raw.githubusercontent.com/tawmae/tawmae/refs/heads/main/assets/page-design/logo-2.webp"
                alt="Logo" />
            <label>Streamer.bot Websocket Connection</label>
        </div>
        <div class="setting-group connection-group">
            <div><label>Address</label><input type="text" id="sb-host"></div>
            <div><label>Port</label><input type="number" id="sb-port"></div>
            <div><label>Password</label><input type="password" id="sb-pass"></div>
        </div>
        <div class="setting-group status-group">
            <span id="status-dot"
                style="width:24px;height:24px;border-radius:50%;background:#f44336;display:inline-block;"></span>
            <span id="status-text" style="font-weight:600; margin-left:10px;">Disconnected</span>
        </div>
        <div class="setting-group"><label class="settings-title">Settings</label></div>
        <div class="setting-group"><label>Hide Messages After X Seconds</label><input type="number" id="hide-after">
            <div class="desc">Hides messages/events after x seconds.</div>
        </div>
        <div class="setting-group"><label>Hide Timestamp</label><label class="toggle-switch"><input type="checkbox"
                    id="hide-timestamp"><span class="slider"></span></label>
            <div class="desc">Hide timestamp.</div>
        </div>
        <div class="setting-group"><label>Hide Pronouns</label><label class="toggle-switch"><input type="checkbox"
                    id="hide-pronouns"><span class="slider"></span></label>
            <div class="desc">Hide pronouns.</div>
        </div>
        <div class="setting-group"><label>Hide Avatars</label><label class="toggle-switch"><input type="checkbox"
                    id="hide-avatars"><span class="slider"></span></label>
            <div class="desc">Hide avatars.</div>
        </div>
        <div class="setting-group"><label>Hide Badges</label><label class="toggle-switch"><input type="checkbox"
                    id="hide-badges"><span class="slider"></span></label>
            <div class="desc">Hide badges.</div>
        </div>
        <div class="setting-group"><label>Hide Icons</label><label class="toggle-switch"><input type="checkbox"
                    id="hide-icons"><span class="slider"></span></label>
            <div class="desc">Hide icons.</div>
        </div>
        <div class="setting-group"><label>Exclude Events</label>
            <div class="checkbox-group">
                
                <label><input type="checkbox" id="evt-announcement" value="announcement">Announcements</label>
                <label><input type="checkbox" id="evt-subscription" value="sub">Subscriptions</label>
                <label><input type="checkbox" id="evt-resubscription" value="resub">Resubscriptions</label>
                <label><input type="checkbox" id="evt-giftsubscription" value="giftsub">Gift Subscriptions</label>
                <label><input type="checkbox" id="evt-giftbomb" value="giftbomb">Gift Bombs</label>
                <label><input type="checkbox" id="evt-rewardredemption" value="rewardredemption">Channel Reward Redemptions</label>
                <label><input type="checkbox" id="evt-watchstreak" value="watchstreak">Watch Streaks</label>
                <label><input type="checkbox" id="evt-cheer" value="cheer">Cheers</label>
                <label><input type="checkbox" id="evt-raid" value="raid">Raids</label>
                <label><input type="checkbox" id="evt-donation" value="donation">Kofi Donations</label>
                <label><input type="checkbox" id="evt-automaticrewardredemption" value="automaticrewardredemption">Automatic Reward Redemptions</label>
            </div>
            <div class="desc">Exclude Twitch events.</div>
        </div>
        <div class="setting-group" id="exclude-accounts-group"><label>Exclude Accounts</label>
            <div id="accounts-list"></div>
            <button id="add-account">+ Add Account</button>
            <div class="desc">Exclude accounts/users.</div>
        </div>
        <div class="setting-group"><label>Exclude Commands</label><label class="toggle-switch"><input type="checkbox"
                    id="exclude-commands"><span class="slider"></span></label>
            <div class="desc">Exclude commands starting with !.</div>
        </div>
        <div class="setting-group"><label>Background</label><label class="toggle-switch"><input type="checkbox"
                    id="background"><span class="slider"></span></label>
            <div class="desc">Toggle background.</div>
        </div>
        <div class="setting-group slider-group"><label>Background Opacity</label><input type="range"
                id="background-opacity" min="0" max="100">
            <div class="slider-value" id="background-opacity-value"></div>
            <div class="desc">Opacity of background.</div>
        </div>
        <div class="setting-group"><label>Background Color</label><input type="color" id="background-color" value="#ffffff">
            <div class="desc">Hex or name.</div>
        </div>
        <div class="setting-group"><label>Background Style</label><select id="background-style">
                <option value="none">none</option>
                <option value="cards">cards</option>
                <option value="cardsRounded">cardsRounded</option>
            </select>
            <div class="desc">none, cards or cardsRounded.</div>
        </div>
        <div class="setting-group"><label>Font</label><input type="text" id="font">
            <div class="desc">Font name.</div>
        </div>
        <div class="setting-group"><label>Font Size</label><input type="number" id="fontsize" min="1" placeholder="16">
            <div class="desc">e.g. 10px.</div>
        </div>
        <div class="setting-group"><label>Dropshadow</label><label class="toggle-switch"><input type="checkbox"
                    id="dropshadow"><span class="slider"></span></label>
            <div class="desc">Toggle dropshadow.</div>
        </div>
        <div class="setting-group"><label>Big Dropshadow</label><label class="toggle-switch"><input type="checkbox"
                    id="big-dropshadow"><span class="slider"></span></label>
            <div class="desc">Larger shadow.</div>
        </div>
        <div class="setting-group"><label>Minimum Reward Cost</label><input type="number" id="min-reward-cost">
            <div class="desc">Min channel points cost.</div>
        </div>
    </div>
    <div class="iframe-container">
        <div class="url-container">
            <img src="https://github.com/tawmae/tawmae/blob/main/url-builder/settings-builder-1.png?raw=true"
                alt="Preview" />
            <div class="url-wrapper">
                <input type="text" id="generated-url" readonly />
                <button id="copy-button">Copy</button>
            </div>
        </div>
        <iframe id="preview-frame"></iframe>
    </div>
    <script>
        const config = {
            baseUrl: 'https://tawmae.xyz/overlays/vertical-chat'
        };
        const elems = {
            sbHost: document.getElementById('sb-host'),
            sbPort: document.getElementById('sb-port'),
            sbPass: document.getElementById('sb-pass'),
            statusDot: document.getElementById('status-dot'),
            statusText: document.getElementById('status-text'),
            hideAfter: document.getElementById('hide-after'),
            hideTimestamp: document.getElementById('hide-timestamp'),
            hidePronouns: document.getElementById('hide-pronouns'),
            hideAvatars: document.getElementById('hide-avatars'),
            hideBadges: document.getElementById('hide-badges'),
            hideIcons: document.getElementById('hide-icons'),
            evtSubs: Array.from(document.querySelectorAll('.checkbox-group input[type="checkbox"]')),
            accountsList: document.getElementById('accounts-list'),
            addAccount: document.getElementById('add-account'),
            excludeCommands: document.getElementById('exclude-commands'),
            background: document.getElementById('background'),
            backgroundOpacity: document.getElementById('background-opacity'),
            backgroundOpacityValue: document.getElementById('background-opacity-value'),
            backgroundColor: document.getElementById('background-color'),
            backgroundStyle: document.getElementById('background-style'),
            font: document.getElementById('font'),
            fontsize: document.getElementById('fontsize'),
            dropshadow: document.getElementById('dropshadow'),
            bigDropshadow: document.getElementById('big-dropshadow'),
            minRewardCost: document.getElementById('min-reward-cost'),
            urlOutput: document.getElementById('generated-url'),
            copyButton: document.getElementById('copy-button'),
            iframe: document.getElementById('preview-frame')
        };

        function initDefaults() {
            elems.sbHost.value = '127.0.0.1';
            elems.sbPort.value = '8080';
            elems.sbPass.value = '';
            elems.hideTimestamp.checked = true;
            elems.hidePronouns.checked = false;
            elems.hideAvatars.checked = false;
            elems.hideBadges.checked = false;
            elems.hideIcons.checked = false;
            elems.evtSubs.forEach(chk => chk.checked = false);
            elems.background.checked = false;
            elems.backgroundOpacity.value = 90;
            elems.backgroundOpacityValue.textContent = 90;
            elems.backgroundStyle.value = 'none';
            elems.dropshadow.checked = false;
            elems.bigDropshadow.checked = false;
        }

        function updateStatus(c) {
            elems.statusDot.style.background = c ? '#4caf50' : '#f44336';
            elems.statusText.textContent = c ? 'Connected' : 'Disconnected';
        }
        let sbClient;

        function connectSB() {
            if (sbClient) sbClient.disconnect();
            sbClient = new StreamerbotClient({
                host: elems.sbHost.value,
                port: Number(elems.sbPort.value),
                password: elems.sbPass.value,
                endpoint: '/',
                onConnect: () => updateStatus(true),
                onDisconnect: () => updateStatus(false)
            });
        } [elems.sbHost, elems.sbPort, elems.sbPass].forEach(el => el.addEventListener('change', connectSB));
        initDefaults();
        connectSB();

        function addAccountItem(val = '') {
            const div = document.createElement('div');
            div.className = 'account-item';
            const inp = document.createElement('input');
            inp.type = 'text';
            inp.className = 'account-input';
            inp.value = val;
            const btn = document.createElement('button');
            btn.textContent = '-';
            btn.addEventListener('click', () => {
                div.remove();
                updateURL();
            });
            div.append(inp, btn);
            elems.accountsList.appendChild(div);
            inp.addEventListener('input', updateURL);
        }
        elems.addAccount.addEventListener('click', e => {
            e.preventDefault();
            addAccountItem();
        });
        addAccountItem();

        function updateURL() {
            let u = config.baseUrl,
                params = [];
            if (elems.sbHost.value && elems.sbHost.value !== '127.0.0.1' && elems.sbHost.value !== 'localhost') params.push(`address=${elems.sbHost.value}`);
            if (elems.sbPort.value && elems.sbPort.value !== '8080') params.push(`port=${elems.sbPort.value}`);
            if (elems.sbPass.value) params.push(`password=${elems.sbPass.value}`);
            if (elems.hideAfter.value) params.push(`hideAfter=${elems.hideAfter.value}`);
            if (!elems.hideTimestamp.checked) params.push('hideTimestamp=false');
            if (elems.hidePronouns.checked) params.push('hidePronouns=true');
            if (elems.hideAvatars.checked) params.push('hideAvatars=true');
            if (elems.hideBadges.checked) params.push('hideBadges=true');
            if (elems.hideIcons.checked) params.push('hideIcons=true');
            const evts = elems.evtSubs.filter(c => c.checked).map(c => c.value).join('+');
            if (evts) params.push(`excludeEvents=${evts}`);
            const accs = Array.from(document.querySelectorAll('.account-input')).map(i => i.value).filter(v => v).join('+');
            if (accs) params.push(`excludeAccounts=${accs}`);
            if (elems.excludeCommands.checked) params.push('excludeCommands=true');
            if (elems.background.checked) params.push('background=true');
            if (elems.backgroundOpacity.value != 90) params.push(`backgroundOpacity=${elems.backgroundOpacity.value}`);
            if (elems.backgroundColor.value && elems.backgroundColor.value !== '#ffffff')
            params.push(`backgroundColor=${encodeURIComponent(elems.backgroundColor.value)}`);
            if (elems.backgroundStyle.value !== 'none') params.push(`backgroundStyle=${elems.backgroundStyle.value}`);
            if (elems.font.value) params.push(`font=${encodeURIComponent(elems.font.value)}`);
            if (elems.fontsize.value) params.push(`fontsize=${elems.fontsize.value}px`);
            if (elems.dropshadow.checked) params.push('dropshadow=true');
            if (elems.bigDropshadow.checked) params.push('bigDropshadow=true');
            if (elems.minRewardCost.value) params.push(`minRewardCost=${elems.minRewardCost.value}`);
            const q = params.length ? `?${params.join('&')}` : '';
            elems.urlOutput.value = u + q;
            elems.iframe.src = u + q;
        }
        const allInputs = document.querySelectorAll('input,select');
        allInputs.forEach(i => i.addEventListener('input', updateURL));
        elems.copyButton.addEventListener('click', () => {
            navigator.clipboard.writeText(elems.urlOutput.value);
            elems.copyButton.textContent = 'Copied!';
            elems.copyButton.classList.add('copied');
            setTimeout(() => {
                elems.copyButton.textContent = 'Copy';
                elems.copyButton.classList.remove('copied');
            }, 2000);
        });
        updateURL();
    </script>
</body>

</html>
